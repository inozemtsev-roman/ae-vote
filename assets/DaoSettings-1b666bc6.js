import{u as O,a as u,b as w,c as p,j as r,F as f,d as v,e as L,S as m,B as A,T as b,f as S,r as M,_ as P,g as D,h as E,L as R,i as F,k as h,M as V}from"./index-1ccf393a.js";function C(){const e=O(B),{daoAddress:n}=u(),s=w(n).data,t=p({initialValues:{ownerAddress:(s==null?void 0:s.daoRoles.owner)||"",proposalOwner:(s==null?void 0:s.daoRoles.proposalOwner)||""},validateOnChange:!1,validateOnBlur:!0,onSubmit:()=>{}});return r(f,{form:e,formik:t})}const B=({name:e,formik:n})=>{const{mutateAsync:s,isLoading:t}=v(),{mutateAsync:i,isLoading:o}=L(),a=n.values[e],d=n.initialValues[e],c=()=>{const l={newOwner:a,onError:y=>n.setFieldError(e,y)};if(e==="ownerAddress")return s(l);if(e==="proposalOwner")return i(l)},g=e==="ownerAddress"?t:o;return d===a?null:r(m,{children:r(A,{onClick:c,isLoading:g,children:r(b,{children:"Update"})})})},Q=()=>({title:"Настройки администратора ДАО",inputs:[{name:"fwdMsgFee",label:"Плата за голос",type:"number",EndAdornment:k}]});function j(){const e=Q(),{daoAddress:n}=u(),{data:s}=S(n),t=p({enableReinitialize:!0,initialValues:{fwdMsgFee:Number(s==null?void 0:s.fwdMsgFee)},validateOnChange:!1,validateOnBlur:!0,onSubmit:()=>{}});return r(f,{form:e,formik:t})}const k=({name:e,formik:n})=>{const{daoAddress:s}=u(),t=n.values[e],i=n.initialValues[e],o=w(s).data,{mutate:a,isLoading:d}=M.useSetDaoFwdMsgFee(),{refetch:c}=S(o==null?void 0:o.daoAddress),g=()=>{if(e==="fwdMsgFee")return a({daoIds:[o.daoId],amount:t,onError:l=>n.setFieldError(e,l),onSuccess:c})};return!P.isNumber(t)||i===t?null:r(m,{children:r(A,{onClick:g,isLoading:d,children:r(b,{children:"Обновить"})})})};function I(){const e=D(),{daoAddress:n}=u(),{isLoading:s,data:t}=w(n),{isOwner:i,isProposalPublisher:o}=E(t==null?void 0:t.daoRoles),a=i||o;return r(R,{title:e.settings,isLoading:s,children:F(h,{children:[r(j,{}),a&&F(h,{children:[r(C,{}),r(V,{})]})]})})}export{I as DaoSettings,I as default};
